潜在変数モデルと EM 的学習法
================================================================================

________________________________________________________________________________
はじめに
--------------------------------------------------------------------------------
### 自己紹介
はじめまして！いしはたです！

### 前置き
この記事は Machine Learning Advent Calendar の 12月8日 の記事として書かれています。

### 内容
今日の内容ですが、生成的確率モデリングに関して述べたいと思います。  
具体的には潜在変数（隠れ変数）を含む確率モデルの学習アルゴリズムについて簡単に解説します。

### 想定する読者

対象は「__機械学習はじめてみよう！__」とか「__確率モデルで遊んでみたい！__」
というビギナー向けのつもりです。  
難易度としては高校時代の同級生が「へー」って言ってくれるレベルを目指します。  
場合によってはあえて正確な表現を避け、簡単な言い回しを用いる予定です。  
なので玄人の方が読むと「__何を今更…__」とか「__それは違うだろ！__」
となると思いますがご容赦ください。

________________________________________________________________________________
潜在変数モデル
--------------------------------------------------------------------------------
### 確率モデルと潜在変数
まず「__潜在変数モデル__」というものについて、簡単な実例を交えて簡単に解説します。  
（簡単を繰り替えしてごめんなさい。）  

確率モデルとはざっくり言えば、__同時分布__ です。  
*生成的* 確率モデルとはざっくり言えば、
__データを生成できる（サンプリングできる）__ 確率モデルです。  
潜在変数モデルとはざっくり言えば、生成的確率モデルのうち、  
観測可能である __観測変数 x__ と観測不能である __潜在変数 z__ を持つものです。  

生成的確率モデルの素敵なところは、データの生成過程を想像できるので、解釈しやすいところです。  
潜在変数モデルの素敵なところは、複雑なデータが大量にあっても、  
それらを潜在変数という不思議なものでなんとなく説明してくれるところです。  

潜在変数モデルの使い道としてもっともポピュラーなものがクラスタリングです。  
データがいっぱいあるけど、実はそれらは潜在的にグループに分かれているという解釈です。  
例えば、テレビの視聴履歴を集めたとします。  
すると潜在グループとして、__オタク__ or __リア充__ などが考えられます。  
データはその潜在グループに依存して生成されると考えます。  
例えばオタク野郎はアニメばっかり観てて、リア充様はドラマとかスポーツとか観てるんじゃねえの？(激怒)  

この潜在変数を推定するといろいろ便利なんです。  
例えば Amazon の購入履歴を考えます。  
クラスタリングの結果「こいつらは潜在的に萌豚えだな」と分かれば、
アニメBD売りたい放題とかなるわけです。  

では具体的にはどうやってその潜在変数を推定するのでしょうか。

### 学習と推論
確率モデルは大抵 __パラメータ__ を持ち、それによって同時分布が確定します。  


### 各学習法の特徴


________________________________________________________________________________
実験
================================================================================
ここでは実際に紹介した４手法を利用してクラスタリングを行ってみます。

### データ
今回は本をクラスタリングしてみます。  
データは私が趣味で作っている本推薦 bot のデータを利用します。  
bot がフォローしているユーザの本棚中の出現頻度 Top 200 の本を持ってきます。  
次にユーザのうち、それらの本のうち大体半分くらいはもっている人を取ってきます。  
最後にユーザと本の関係を行列で表現します。
縦軸を本、横軸をユーザ、行列の値を

- 0:本を持ってない
- 1:本を持ってる
- 2:本を持ってる、かつ、高評価

の３値で表現します。  
この行列の各列をデータと思って本をクラスタリングしてみます。

### 結果

________________________________________________________________________________
最後に
================================================================================
